---
title: "Preço de Venda de Imóveis"
author: "Elton Dantas de Oliveira Mesquita"
output:
  html_document:
    theme: readable
    highlight: breezedark
    toc: true
    toc_depth: 5
    toc_float:
      collapsed: false
      smooth_scroll: false
---

```{=html}
<style> body {text-align: justify} </style>
```
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)

library(rmarkdown); pandoc_version()
```

## Pacotes

```{r}
library(tidyverse)
library(plotly)
library(GGally)
library(gridExtra)
library(ggfortify)
```

## Dados

Exemplo disponível em: Paula, G. A. (2013). [Modelos de Regressão com Apoio Computacional](https://www.ime.usp.br/~giapaula/texto_2013.pdf). São Paulo, SP: IME-USP. (Exercício 23, página 112). Dados disponíveis em: <https://www.ime.usp.br/~giapaula/textoregressao.htm>

Neste trabalho, vamos modelar o preço de venda de imóveis a partir de dados relativos a uma amostra de 27 imóveis. As variáveis desse conjunto de dados são:

-   ***imposto***: imposto do imóvel (em US\$ 100);

-   ***areaT***: área do terreno (em 1.000 pés quadrados);

-   ***areaC***: área construída (em 1.000 pés quadrados);

-   ***idade***: idade da residência (em anos);

-   ***preco***: preço de venda do imóvel (em US\$ 1.000).

Sendo assim, o objetivo dessa modelo é explicar a variável ***preço de venda*** a partir das variáveis ***área do terreno***, ***área construída*** e ***idade***.

```{r}
dados = read.table("imoveis.dat")
colnames(dados) = c("imposto", "areaT", "areaC", "idade", "preco")
attach(dados)
dados
```

## Análise Descritiva

### Box-plots

O gráfico interativo abaixo nos mostra as medidas resumo para cada uma das variáveis.

```{r}
plot_ly(type = "box") %>%
  add_boxplot(y = imposto, name = "imposto") %>% 
  add_boxplot(y = areaT, name = "área do terreno") %>% 
  add_boxplot(y = areaC, name = "área construída") %>%
  add_boxplot(y = idade, name = "idade do imóvel") %>%
  add_boxplot(y = preco, name = "preço de venda")
```

### Densidade, dispersão e correlação

```{r}
ggpairs(dados, aes(color = I("slategray4"), fill = I("slategray3")),
        alpha = 0.5, lower = list(continuous = "smooth"))
```

## Ajuste 1

### Modelo

```{r}
model1 = lm(preco~1,dados)
summary(model1)
```

### Análise de resíduos

```{r}
# autoplot(broomify(lm(preco~.,dados)))
# autoplot(lm(preco~.,dados))
# plot(fortify(lm(preco~.,dados)))
# 
par(mfrow=c(2,2),mar=c(5,5,5,5),mai=c(2,2,2,2))
plot(lm(preco~.,dados), which = 1:4, pch=16)
# diagP

par(mai=c(100,100,100,100))
m = lm(preco ~ ., dados)

autoplot(m, which = 1, ncol = 1,
         label.size = 3, label.colour = "red",label.hjust = -1,
         lwd = 2)

autoplot(m, which = 2, 
         label.size = 3, label.colour = "red",label.hjust = -0.5)
```
